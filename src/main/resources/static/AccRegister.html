<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>숙소등록</title>
    <style>
        @font-face {
            font-family: 'Pretendard-Regular';
            src: url('https://fastly.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Regular.woff') format('woff');
            font-weight: 400;
            font-style: normal;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Pretendard-Regular;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f9f9f9;
        }

        form {
            width: 900px;
            padding: 20px;
            border: 1px solid #B2D055;
            border-radius: 10px;
            background-color: #ffffff;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
        }

        fieldset {
            border: 1px solid #B2D055;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        legend {
            font-weight: bold;
            color: #5A7D27;
            margin-bottom: 15px;
        }

        label {
            font-size: 14px;
            color: #333;
            display: inline-block;
            width: 120px;
            margin-right: 10px;
        }
        input[type="number"],
        input[type="text"],
        input[type="tel"],
        select {
            width: calc(100% - 150px);
            padding: 8px 10px;
            border: 1px solid #B2D055;
            border-radius: 4px;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .flex-container {
            display: flex;
            justify-content: space-between;
            gap: 30px;
        }

        .left-section,
        .right-section {
            width: 48%;
        }
        .right-section {
            line-height : 30px;
        }

        button,
        input[type="button"],
        input[type="submit"] {
            display: inline-block;
            padding: 10px 15px;
            border: none;
            background-color: #B2D055;
            color: #fff;
            font-size: 14px;
            cursor: pointer;
            border-radius: 4px;
            margin: 5px;
            transition: background-color 0.3s ease;
        }

        button:hover,
        input[type="button"]:hover,
        input[type="submit"]:hover {
            background-color: #8dbf3d;
        }
        input[type="radio"]{
        display : none;
        }

        .input-group
        .radio-group,
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        input[type="radio"]:checked+span {
            color: #B2D055;
        }

        .button-container {
            text-align: center;
            margin-top: 20px;
        }

        textarea {
            width: 100%;
            height: 100%;
            padding: 10px;
            font-size: 14px;
            border: none;
            resize: none;
            outline: none;
        }

        .file-upload-wrapper {
            display: inline-block;
            position: relative;
        }

        .file-upload {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .file-upload-label {
            display: inline-block;
            padding: 10px 20px;
            background-color: #B2D055;
            color: #fff;
            font-size: 14px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .file-upload-label:hover {
            background-color: #8dbf3d;
        }

        .preview-image {
            width: 95%;
            height: 200px;
            object-fit: cover;
            border: 1px solid #ddd;
            display: none;
            margin: 10px 0;
        }

    </style>
</head>

<body>

<form id="accRegisterForm" method="post" enctype="multipart/form-data">
    <input type="hidden" name="id" value="testID">
    <fieldset>
        <legend>요금 설정</legend>
        <div class="flex-container">
            <!-- 왼쪽 섹션: 기본 요금 및 인원 제한 -->
            <div class="left-section">
                <label>기본 요금</label>
                <input type="number" name="price" min="0" step="1000" required>
                <br>
                <label>기본 인원 제한</label>
                <input type="number" name="ocupacy" required>
            </div>

            <!-- 오른쪽 섹션: 초과 요금 및 최대 인원 -->
            <div class="right-section">
                <label>초과 인원 요금 (대인)</label>
                <input type="number" name="adultPrice" min="0" step="1000">
                <br>
                <label>초과 인원 요금 (소인)</label>
                <input type="number" name="childPrice" min="0" step="1000">
                <br>
                <label>최대 초과 인원</label>
                <input type="number" name="maximumOcupacy" placeholder="기본 인원 포함하여 작성해주세요">
            </div>
        </div>
    </fieldset>

    <fieldset>
        <legend>숙소 정보</legend>
        <div class="flex-container">
            <!-- 왼쪽: 이미지 업로드 -->
            <div class="left-section">
                <div style="overflow: hidden; white-space: nowrap;">
                    <legend style="text-align : center; background-color: #8dbf3d;"> 이미지 삽입
                        <div class="file-upload-wrapper">
                            <input type="file" class="file-upload" id="imageUpload" accept="image/*" multiple>
                            <label for="imageUpload" class="file-upload-label">파일 선택</label>
                        </div>
                        <button class="navigation-button" id="prevButton" type="button">이전</button>
                        <button class="navigation-button" id="nextButton" type="button">다음</button>
                    </legend>
                    <img id="previewImage" class="preview-image" src="#" alt="이미지 미리보기">
                </div>
            </div>

            <!-- 오른쪽: 숙소 전화번호, 판매유형, 카테고리 -->
            <div class="right-section">
                <fieldset>
                    <table>
                        <tr>
                            <td><label>숙소 전화번호</label></td>
                            <td><input type="tel" name="accCall" style="width : 95%"></td>
                        </tr>
                        <tr>
                            <td><label>판매 유형</label></td>
                            <td>
                                <div class="radio-group">
                                    <label><input type="radio" name="accType"
                                                  value="guesthouse"><span>게스트하우스</span></label>
                                    <label><input type="radio" name="accType" value="rentalhome"><span>펜션</span></label>
                                    <label><input type="radio" name="accType" value="hotel"><span>호텔</span></label>
                                    <label><input type="radio" name="accType" value="camping"><span>캠핑장</span></label>
                                    <label><input type="radio" name="accType" value="poolvilla"><span>풀빌라</span></label>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td><label>카테고리</label></td>
                            <td><input type="text" name="category" list="categorylist" style="width : 95%"></td>
                            <datalist id="categorylist">
                                <option>바다</option>
                                <option>산</option>
                                <option>섬</option>
                                <option>도시</option>
                            </datalist>
                        </tr>
                    </table>
                </fieldset>
            </div>
        </div>
        <br>
        <!-- 주소 입력 필드 -->
        <div>
            <legend>숙소 주소</legend>
            <input type="text" id="postcode" placeholder="우편번호" name="postcode" readonly style="width: calc(90% - 100px);" required>
            <input type="button" onclick="execDaumPostcode()" value="우편번호 찾기"><br>
            <input type="text" id="address" placeholder="주소" name="address1" style="width : 100%" readonly required><br>
            <input type="text" id="detailAddress" name="detailAddress" style="width : 100%" placeholder="상세주소" required><br>
            <div id="wrap"
                 style="display:none;border:1px solid;width:500px;height:300px;margin:5px 0;position:relative">
                <img src="//t1.daumcdn.net/postcode/resource/images/close.png" id="btnFoldWrap"
                     style="cursor:pointer;position:absolute;right:0px;top:-1px;z-index:1" onclick="foldDaumPostcode()"
                     alt="접기 버튼">
            </div>
        </div>
    </fieldset>
    <fieldset>
        <legend>상세소개</legend>
        <textarea name="informtext" rows="20" cols="50"></textarea>
    </fieldset>
    <fieldset>
        <legend>숙소규칙</legend>
        <textarea name="accomRule" rows="10" cols="50"></textarea>
    </fieldset>

    <fieldset>
        <legend>운영 상태</legend>
        <div class="button-container">
            <input type="submit" id="registerUpdate" value="등록/수정">
            <input type="submit" id="stopReservation" value="예약중지">
            <input type="submit" id="deleteAccommodation" value="숙소삭제">
        </div>
    </fieldset>
</form>

<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
    // 우편번호 찾기 찾기 화면을 넣을 element
    var element_wrap = document.getElementById('wrap');

    function foldDaumPostcode() {
        // iframe을 넣은 element를 안보이게 한다.
        element_wrap.style.display = 'none';
    }

    function execDaumPostcode() {
        // 현재 scroll 위치를 저장해놓는다.
        var currentScroll = Math.max(document.body.scrollTop, document.documentElement.scrollTop);
        new daum.Postcode({
            oncomplete: function (data) {
                // 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

                // 각 주소의 노출 규칙에 따라 주소를 조합한다.
                // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
                var addr = ''; // 주소 변수

                // 사용자가 선택한 주소 타입에 따라 해당 주소 값을 가져온다.
                if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
                    addr = data.roadAddress;
                } else { // 사용자가 지번 주소를 선택했을 경우(J)
                    addr = data.jibunAddress;
                }

                // 우편번호와 주소 정보를 해당 필드에 넣는다.
                document.getElementById('postcode').value = data.zonecode;
                document.getElementById("address").value = addr;
                // 커서를 상세주소 필드로 이동한다.
                document.getElementById("detailAddress").focus();

                // 상세주소 입력 가능하도록 설정
                document.getElementById("detailAddress").removeAttribute("readonly");

                // iframe을 넣은 element를 안보이게 한다.
                // (autoClose:false 기능을 이용한다면, 아래 코드를 제거해야 화면에서 사라지지 않는다.)
                element_wrap.style.display = 'none';

                // 우편번호 찾기 화면이 보이기 이전으로 scroll 위치를 되돌린다.
                document.body.scrollTop = currentScroll;
            },
            // 우편번호 찾기 화면 크기가 조정되었을때 실행할 코드를 작성하는 부분. iframe을 넣은 element의 높이값을 조정한다.
            onresize: function (size) {
                element_wrap.style.height = size.height + 'px';
            },
            width: '100%',
            height: '100%'
        }).embed(element_wrap);

        // iframe을 넣은 element를 보이게 한다.
        element_wrap.style.display = 'block';
    }
</script>
<script>
    const form = document.getElementById('accRegisterForm');
    const registerUpdateButton = document.getElementById('registerUpdate');
    const stopReservationButton = document.getElementById('stopReservation');
    const deleteAccommodationButton = document.getElementById('deleteAccommodation');

    registerUpdateButton.addEventListener('click', function (event) {
    if (form.checkValidity()) { // 폼의 유효성 검사를 통과한 경우
        form.action = "accUpload"; // 등록/수정 URL 설정
        form.submit(); // 명시적 제출
    } else {
        alert('필수 항목을 모두 입력해주세요.');
    }
    });

    stopReservationButton.addEventListener('click', function (event) {
    if (form.checkValidity()) { // 폼의 유효성 검사를 통과한 경우
        form.action = "controller2"; // 등록/수정 URL 설정
        form.submit(); // 명시적 제출
    } else {
        alert('필수 항목을 모두 입력해주세요.');
    }
    });

    deleteAccommodationButton.addEventListener('click', function (event) {
    if (form.checkValidity()) { // 폼의 유효성 검사를 통과한 경우
        form.action = "controller3"; // 등록/수정 URL 설정
        form.submit(); // 명시적 제출
    } else {
        alert('필수 항목을 모두 입력해주세요.');
    }
    });
</script>
<script>
    const imageUpload = document.getElementById('imageUpload');  // 파일 선택 input
    const previewImage = document.getElementById('previewImage');  // 미리보기 이미지 태그
    const prevButton = document.getElementById('prevButton');  // 이전 버튼
    const nextButton = document.getElementById('nextButton');  // 다음 버튼

    let images = [];  // 선택된 이미지들을 저장할 배열
    let currentIndex = 0;  // 현재 보여주는 이미지의 인덱스

    // 파일 선택 시 실행되는 함수
    imageUpload.addEventListener('change', function (event) {
        const files = event.target.files;

        // 파일이 선택된 경우에만 실행
        if (files.length > 0) {
            images = [];  // 기존 이미지 배열 초기화

            // FileList를 배열로 변환하여 이미지 파일들을 저장
            Array.from(files).forEach(file => {
                const reader = new FileReader();

                // 파일이 읽히면 실행되는 함수
                reader.onload = function (e) {
                    images.push(e.target.result);  // 파일의 Data URL을 배열에 추가

                    // 첫 번째 이미지를 미리보기로 설정
                    if (images.length === 1) {
                        previewImage.src = images[0];  // 첫 번째 이미지 표시
                        previewImage.style.display = 'block';  // 미리보기 이미지 보이기
                        prevButton.style.display = 'inline-block';  // 이전 버튼 표시
                        nextButton.style.display = 'inline-block';  // 다음 버튼 표시
                    }
                };

                reader.readAsDataURL(file);  // 파일을 읽어서 Data URL로 변환
            });
        }
    });

    prevButton.addEventListener('click', function (event) {
        event.preventDefault(); // 기본 동작 방지
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        previewImage.src = images[currentIndex];
    });

    nextButton.addEventListener('click', function (event) {
        event.preventDefault(); // 기본 동작 방지
        currentIndex = (currentIndex + 1) % images.length;
        previewImage.src = images[currentIndex];
    });
</script>
</body>

</html>